# xlwings Added as Optional Dependency - 2025-09-06 01:25

## Changes Made

### 1. Updated setup.py
**Added optional dependency for Excel file generation:**

```python
# Optional dependencies for Excel file generation
EXCEL_GENERATION_REQUIRE = [
    'xlwings; platform_system=="Windows"',  # Windows-only for Excel integration
]

extras_require=dict(
    # ... existing extras ...
    excel_generation=EXCEL_GENERATION_REQUIRE,
),
```

### 2. Installation Options
**Users can now install xlwings in multiple ways:**

```bash
# Option 1: Direct installation
pip install xlwings

# Option 2: As optional dependency
pip install xlcalculator[excel_generation]

# Option 3: Development installation with excel generation
pip install -e .[excel_generation]
```

### 3. Platform Constraint
**xlwings only installs on Windows:**
- Uses `platform_system=="Windows"` constraint
- Prevents installation errors on Linux/macOS
- xlwings requires Windows + Microsoft Excel anyway

### 4. Documentation Updates
**Updated README_XLWINGS.md:**
- Added installation options
- Documented optional dependency approach
- Clear requirements explanation

**Created requirements-excel-generation.txt:**
- Standalone requirements file for Excel generation
- Clear documentation of Windows/Excel requirements
- Alternative installation method

### 5. Updated Generator Help
**generate_all_xlwings.py help text:**
- Shows both installation options
- Clear requirements documentation

## Benefits

### For Users
✅ **Optional installation** - xlwings only installed when needed  
✅ **Platform awareness** - No installation errors on non-Windows systems  
✅ **Clear requirements** - Explicit Windows/Excel dependency documentation  
✅ **Multiple install paths** - Flexibility in how to install dependencies  

### For Developers
✅ **Clean separation** - Excel generation is optional feature  
✅ **CI/CD friendly** - Tests can run without xlwings on Linux  
✅ **Documentation** - Clear setup instructions for contributors  

### For CI/CD
✅ **Linux compatibility** - Core tests run without Windows dependencies  
✅ **Selective installation** - Only install xlwings when generating Excel files  
✅ **No platform conflicts** - xlwings constraint prevents installation issues  

## Usage Examples

### For End Users
```bash
# Install xlcalculator with Excel generation support
pip install xlcalculator[excel_generation]

# Generate Excel files (Windows only)
python generate_all_xlwings.py ../resources
```

### For Developers
```bash
# Development installation with Excel generation
git clone repo
cd xlcalculator
pip install -e .[excel_generation]

# Or install just for testing
pip install -e .[test]
```

### For CI/CD
```bash
# Linux CI - core tests only
pip install -e .[test]
python -m pytest tests/

# Windows CI - with Excel generation
pip install -e .[test,excel_generation]
python -m pytest tests/
python generate_all_xlwings.py --check-only
```

## File Structure

```
tests/resources_generator/
├── README_XLWINGS.md                    # Updated with install options
├── requirements-excel-generation.txt    # Standalone requirements
├── generate_all_xlwings.py             # Updated help text
├── xlwings_*.py                         # Individual generators
└── ...
```

## Validation

✅ **setup.py syntax valid**  
✅ **EXCEL_GENERATION_REQUIRE variable added**  
✅ **excel_generation extra configured**  
✅ **Windows platform constraint applied**  
✅ **Documentation updated**  

The xlwings dependency is now properly configured as an optional, platform-specific dependency for Excel file generation.