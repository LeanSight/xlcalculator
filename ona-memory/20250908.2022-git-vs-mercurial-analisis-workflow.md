# Git vs Mercurial: Workflow de An√°lisis para OpenPyXL

## Diferencias Cr√≠ticas para el An√°lisis

### **üîÑ Comandos Equivalentes**

| Operaci√≥n | Git | Mercurial | Notas |
|-----------|-----|-----------|-------|
| **Clonar** | `git clone URL` | `hg clone URL` | Mercurial crea directorio autom√°ticamente |
| **Estado** | `git status` | `hg status` | Salida similar |
| **Historial** | `git log` | `hg log` | Mercurial usa templates |
| **Branches** | `git branch` | `hg branches` | Conceptos diferentes |
| **Diferencias** | `git diff` | `hg diff` | Sintaxis similar |
| **Buscar** | `git grep` | `hg grep` | Funcionalidad equivalente |
| **Blame** | `git blame` | `hg annotate` | Mismo prop√≥sito |

### **üìä Comandos de An√°lisis Espec√≠ficos**

#### **Exploraci√≥n de Historial**
```bash
# Git
git log --oneline --grep="cached"
git log --since="2024-01-01" --pretty=format:"%h %s"
git log --follow path/to/file.py

# Mercurial
hg log -k "cached" --template "{rev}: {desc}\n"
hg log -d "2024-01-01 to 2024-12-31" --template "{rev}: {desc}\n"
hg log path/to/file.py --template "{rev}: {desc}\n"
```

#### **B√∫squeda en C√≥digo**
```bash
# Git
git grep -n "cached_value"
git grep -l "WorksheetReader"

# Mercurial  
hg grep -n "cached_value"
hg grep -l "WorksheetReader"
```

#### **An√°lisis de Cambios**
```bash
# Git
git show HEAD~5:path/file.py
git diff HEAD~10..HEAD path/file.py

# Mercurial
hg cat -r -5 path/file.py
hg diff -r -10:-1 path/file.py
```

## Workflow de An√°lisis Adaptado

### **üéØ Setup Inicial para Mercurial**

#### **1. Instalaci√≥n y Configuraci√≥n**
```bash
# Instalar Mercurial
sudo apt-get update && sudo apt-get install mercurial

# Configurar usuario
cat > ~/.hgrc << EOF
[ui]
username = Ona Analysis <ona@analysis.com>
editor = nano

[extensions]
color =
pager =
EOF
```

#### **2. Clonado del Repositorio Oficial**
```bash
# Clonar openpyxl oficial
cd /workspace/
hg clone https://foss.heptapod.net/openpyxl/openpyxl openpyxl-official

# Verificar clonado
cd openpyxl-official/
hg summary
hg parents
```

#### **3. Exploraci√≥n Inicial**
```bash
# Ver estructura
find . -name "*.py" | head -20

# Ver historial reciente
hg log --limit 10 --template "{rev}: {date|shortdate} - {desc}\n"

# Ver branches disponibles
hg branches
```

### **üîç Comandos de An√°lisis Espec√≠ficos para OpenPyXL**

#### **Buscar APIs Relevantes**
```bash
# Buscar WorksheetReader
hg grep -n "class WorksheetReader"
hg grep -l "WorksheetReader"

# Buscar cached values
hg grep -n "cached"
hg grep -n "cvalue"

# Buscar cell parsing
hg grep -n "parse_cell"
hg grep -n "data_type.*f"
```

#### **Analizar Historial de Archivos Clave**
```bash
# Historial de WorksheetReader
hg log openpyxl/worksheet/_reader.py --template "{rev}: {date|shortdate} - {desc}\n"

# Historial de Cell class
hg log openpyxl/cell/cell.py --template "{rev}: {date|shortdate} - {desc}\n"

# Cambios recientes en parsing
hg log -k "parse" --limit 20 --template "{rev}: {desc}\n"
```

#### **Examinar C√≥digo Espec√≠fico**
```bash
# Ver contenido actual
hg cat openpyxl/worksheet/_reader.py
hg cat openpyxl/cell/cell.py

# Ver versi√≥n espec√≠fica
hg cat -r 100 openpyxl/cell/cell.py

# Ver anotaciones (blame)
hg annotate openpyxl/worksheet/_reader.py | grep -i cache
```

### **üìã Templates de Comandos para Ona**

#### **Exploraci√≥n Inicial**
```bash
ona> "Ejecuta 'hg summary' en openpyxl-official/ y documenta la informaci√≥n del repositorio"

ona> "Usa 'hg log --limit 20 --template \"{rev}: {date|shortdate} - {desc}\\n\"' para ver commits recientes y identificar patrones de desarrollo"

ona> "Ejecuta 'find openpyxl-official/ -name \"*reader*\" -o -name \"*cell*\"' para localizar archivos relevantes"
```

#### **An√°lisis de APIs**
```bash
ona> "Analiza el contenido de 'hg cat openpyxl/worksheet/_reader.py' y documenta la clase WorksheetReader"

ona> "Examina 'hg cat openpyxl/cell/cell.py' y identifica propiedades relacionadas con f√≥rmulas y valores"

ona> "Usa 'hg grep -n \"data_type.*f\"' para encontrar manejo de f√≥rmulas en el c√≥digo"
```

#### **Investigaci√≥n de Historial**
```bash
ona> "Ejecuta 'hg log -k \"cached\" --template \"{rev}: {desc}\\n\"' y analiza commits relacionados con cached values"

ona> "Usa 'hg log openpyxl/cell/cell.py --limit 10' para entender la evoluci√≥n de la clase Cell"

ona> "Analiza 'hg annotate openpyxl/worksheet/_reader.py' para identificar autores de c√≥digo relevante"
```

## Diferencias en el An√°lisis

### **üîÑ Conceptos Diferentes**

#### **Branches vs Bookmarks**
```bash
# Git branches (lightweight)
git branch feature-analysis
git checkout feature-analysis

# Mercurial branches (permanent)
hg branch feature-analysis  # Crea branch permanente
# O usar bookmarks (equivalente a Git branches)
hg bookmark feature-analysis
hg update feature-analysis
```

#### **Commits y Revisiones**
```bash
# Git usa SHA hashes
git show 1a2b3c4d

# Mercurial usa n√∫meros de revisi√≥n + hash
hg log -r 123
hg log -r 1a2b3c4d
```

#### **Referencias Relativas**
```bash
# Git
git show HEAD~5
git diff HEAD~10..HEAD

# Mercurial
hg log -r -5
hg diff -r -10:-1
```

### **üéØ Ventajas de Mercurial para An√°lisis**

#### **1. Templates Poderosos**
```bash
# Formato personalizado f√°cil
hg log --template "{rev}: {author|person} - {date|shortdate} - {desc|firstline}\n"

# Informaci√≥n detallada
hg log --template "Revision: {rev}\nAuthor: {author}\nDate: {date}\nFiles: {files}\nDescription: {desc}\n\n"
```

#### **2. Numeraci√≥n Secuencial**
```bash
# F√°cil referencia a commits
hg log -r 100:110  # Rango espec√≠fico
hg diff -r 100:105 # Diferencias entre revisiones
```

#### **3. Comandos Integrados**
```bash
# Informaci√≥n rica sin plugins
hg summary        # Estado completo del repo
hg paths          # URLs remotas
hg identify       # Revisi√≥n actual
```

## Workflow Espec√≠fico para OpenPyXL

### **üîç Proceso de An√°lisis Paso a Paso**

#### **Fase 1: Reconocimiento**
```bash
# 1. Clonar y explorar
hg clone https://foss.heptapod.net/openpyxl/openpyxl openpyxl-official
cd openpyxl-official/

# 2. Entender estructura
hg summary
hg log --limit 5
find . -name "*.py" | grep -E "(reader|cell|worksheet)" | head -10

# 3. Identificar archivos clave
hg grep -l "WorksheetReader"
hg grep -l "parse_cell"
```

#### **Fase 2: An√°lisis Profundo**
```bash
# 4. Examinar WorksheetReader
hg cat openpyxl/worksheet/_reader.py > /tmp/reader_analysis.py
hg log openpyxl/worksheet/_reader.py --limit 10

# 5. Examinar Cell class
hg cat openpyxl/cell/cell.py > /tmp/cell_analysis.py
hg annotate openpyxl/cell/cell.py | grep -i "value\|formula"

# 6. Buscar cached values
hg grep -n "cached"
hg grep -n "cvalue"
```

#### **Fase 3: Investigaci√≥n Hist√≥rica**
```bash
# 7. Historial de features relevantes
hg log -k "formula" --template "{rev}: {date|shortdate} - {desc}\n"
hg log -k "cached" --template "{rev}: {date|shortdate} - {desc}\n"

# 8. Cambios recientes importantes
hg log --since="2024-01-01" --template "{rev}: {desc}\n" | grep -i "cell\|formula\|reader"

# 9. Identificar mantenedores activos
hg log --limit 50 --template "{author|person}\n" | sort | uniq -c | sort -nr
```

### **üìä Documentaci√≥n del An√°lisis**

#### **Template de Reporte**
```markdown
# An√°lisis OpenPyXL - Repositorio Oficial

## Informaci√≥n del Repositorio
- **URL**: https://foss.heptapod.net/openpyxl/openpyxl
- **Revisi√≥n actual**: [hg identify]
- **√öltima actualizaci√≥n**: [hg log -r tip --template "{date}"]

## Archivos Clave Identificados
- **WorksheetReader**: openpyxl/worksheet/_reader.py
- **Cell Class**: openpyxl/cell/cell.py
- **Formula Handling**: [archivos encontrados]

## APIs Relevantes para xlcalculator
- [Lista de m√©todos y propiedades]

## Historial de Cambios Relevantes
- [Commits importantes relacionados con cached values]

## Oportunidades de Integraci√≥n
- [An√°lisis espec√≠fico basado en c√≥digo oficial]
```

## Comandos de Emergencia

### **üö® Si Mercurial Falla**

#### **Conversi√≥n a Git (√öltimo Recurso)**
```bash
# Instalar hg-git
pip install hg-git

# Configurar extensi√≥n
echo "[extensions]" >> ~/.hgrc
echo "hggit =" >> ~/.hgrc

# Convertir a Git
hg clone https://foss.heptapod.net/openpyxl/openpyxl openpyxl-hg
cd openpyxl-hg/
hg gexport ../openpyxl-git
```

#### **An√°lisis Offline**
```bash
# Descargar snapshot
wget https://foss.heptapod.net/openpyxl/openpyxl/-/archive/tip/openpyxl-tip.tar.gz
tar -xzf openpyxl-tip.tar.gz

# An√°lisis b√°sico sin historial
find openpyxl-tip/ -name "*.py" | xargs grep -l "WorksheetReader"
```

## Conclusi√≥n

El uso de **Mercurial** requiere adaptaci√≥n pero ofrece ventajas espec√≠ficas:

### **‚úÖ Ventajas**
- **Templates poderosos** para an√°lisis de historial
- **Numeraci√≥n secuencial** f√°cil de referenciar
- **Comandos integrados** ricos en informaci√≥n
- **Acceso al c√≥digo oficial** m√°s actualizado

### **‚ö†Ô∏è Consideraciones**
- **Curva de aprendizaje** para comandos diferentes
- **Menos familiaridad** que Git
- **Herramientas espec√≠ficas** para Mercurial

**Recomendaci√≥n**: Proceder con Mercurial para acceso oficial, manteniendo documentaci√≥n de comandos equivalentes para facilitar el workflow.