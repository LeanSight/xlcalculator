{
  "metadata": {
    "title": "Sheet Context Behavior",
    "description": "Test suite for Excel sheet context behavior with implicit and explicit references",
    "total_cases": 8,
    "source": "ATDD sheet context requirements",
    "purpose": "Verify that implicit references resolve to the correct sheet context"
  },
  "generation_config": {
    "class_name": "SheetContextIntegrationTest",
    "test_description": "Integration tests for sheet context behavior",
    "class_docstring": "These tests validate Excel sheet context behavior for implicit references",
    "excel_filename": "sheet_context_test.xlsx",
    "test_filename": "test_sheet_context_integration.py",
    "label_row": 20
  },
  "data_sheet": {
    "name": "Sheet1",
    "headers": ["A", "B", "C", "D"],
    "rows": [
      [10, 5, "=SUM(A1:A3)", "=Sheet2!C1"],
      [20, 15, "=A1 + Sheet2!A1", null],
      [30, 25, null, null]
    ]
  },
  "auxiliary_data": {
    "Sheet2!A1": 100,
    "Sheet2!A2": 200,
    "Sheet2!A3": 300,
    "Sheet2!B1": 50,
    "Sheet2!B2": 150,
    "Sheet2!B3": 250,
    "Sheet2!C1": "=SUM(A1:A3)",
    "Sheet2!C2": "=A1 + Sheet1!A1",
    "Sheet2!D1": "=Sheet1!C1"
  },
  "levels": [
    {
      "level": "1",
      "title": "Implicit Reference Context",
      "description": "Test that implicit references use formula sheet context",
      "cell_range": "A1:A2",
      "category": "core_behavior",
      "test_cases": [
        {
          "cell": "A1",
          "formula": "=Sheet1!C1",
          "expected_value": 60,
          "expected_type": "number",
          "description": "Sheet1 formula with implicit range should sum Sheet1 values (10+20+30=60)"
        },
        {
          "cell": "A2", 
          "formula": "=Sheet2!C1",
          "expected_value": 600,
          "expected_type": "number",
          "description": "Sheet2 formula with implicit range should sum Sheet2 values (100+200+300=600)"
        }
      ]
    },
    {
      "level": "2",
      "title": "Mixed References",
      "description": "Test mixed explicit and implicit references in same formula",
      "cell_range": "B1:B2",
      "category": "mixed_behavior",
      "test_cases": [
        {
          "cell": "B1",
          "formula": "=Sheet1!C2", 
          "expected_value": 110,
          "expected_type": "number",
          "description": "Mixed reference: implicit A1 (Sheet1) + explicit Sheet2!A1 = 10+100=110"
        },
        {
          "cell": "B2",
          "formula": "=Sheet2!C2",
          "expected_value": 110, 
          "expected_type": "number",
          "description": "Mixed reference: implicit A1 (Sheet2) + explicit Sheet1!A1 = 100+10=110"
        }
      ]
    },
    {
      "level": "3",
      "title": "Cross-Sheet References",
      "description": "Test cross-sheet formula references",
      "cell_range": "C1:C2",
      "category": "cross_sheet",
      "test_cases": [
        {
          "cell": "C1",
          "formula": "=Sheet1!D1",
          "expected_value": 600,
          "expected_type": "number", 
          "description": "Sheet1 referencing Sheet2 formula result should return 600"
        },
        {
          "cell": "C2",
          "formula": "=Sheet2!D1", 
          "expected_value": 60,
          "expected_type": "number",
          "description": "Sheet2 referencing Sheet1 formula result should return 60"
        }
      ]
    },
    {
      "level": "4",
      "title": "Data Integrity",
      "description": "Verify base data values are correct",
      "cell_range": "D1:D2",
      "category": "data_validation",
      "test_cases": [
        {
          "cell": "D1",
          "formula": "=Sheet1!A1",
          "expected_value": 10,
          "expected_type": "number",
          "description": "Sheet1 A1 should contain value 10"
        },
        {
          "cell": "D2", 
          "formula": "=Sheet2!A1",
          "expected_value": 100,
          "expected_type": "number",
          "description": "Sheet2 A1 should contain value 100"
        }
      ]
    }
  ]
}