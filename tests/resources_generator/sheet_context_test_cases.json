{
  "metadata": {
    "title": "Sheet Context Behavior",
    "description": "Test suite for Excel sheet context behavior with implicit and explicit references",
    "total_cases": 8,
    "source": "ATDD sheet context requirements",
    "purpose": "Verify that implicit references resolve to the correct sheet context"
  },
  "generation_config": {
    "class_name": "SheetContextIntegrationTest",
    "test_description": "Integration tests for sheet context behavior",
    "class_docstring": "These tests validate Excel sheet context behavior for implicit references",
    "excel_filename": "sheet_context_test.xlsx",
    "test_filename": "test_sheet_context_integration.py"
  },
  "workbook_config": {
    "sheets": [
      {
        "name": "Sheet1",
        "data": {
          "A1": 10,
          "A2": 20,
          "A3": 30,
          "B1": 5,
          "B2": 15,
          "B3": 25
        },
        "formulas": {
          "C1": "=SUM(A1:A3)",
          "C2": "=A1 + Sheet2!A1",
          "D1": "=Sheet2!C1"
        }
      },
      {
        "name": "Sheet2", 
        "data": {
          "A1": 100,
          "A2": 200,
          "A3": 300,
          "B1": 50,
          "B2": 150,
          "B3": 250
        },
        "formulas": {
          "C1": "=SUM(A1:A3)",
          "C2": "=A1 + Sheet1!A1",
          "D1": "=Sheet1!C1"
        }
      }
    ]
  },
  "test_cases": [
    {
      "level": "1",
      "title": "Implicit Reference Context",
      "description": "Test that implicit references use formula sheet context",
      "category": "core_behavior",
      "cases": [
        {
          "cell": "Sheet1!C1",
          "formula": "=SUM(A1:A3)",
          "expected_value": 60,
          "expected_type": "number",
          "description": "Sheet1 formula with implicit range should sum Sheet1 values (10+20+30=60)"
        },
        {
          "cell": "Sheet2!C1", 
          "formula": "=SUM(A1:A3)",
          "expected_value": 600,
          "expected_type": "number",
          "description": "Sheet2 formula with implicit range should sum Sheet2 values (100+200+300=600)"
        }
      ]
    },
    {
      "level": "2",
      "title": "Mixed References",
      "description": "Test mixed explicit and implicit references in same formula",
      "category": "mixed_behavior",
      "cases": [
        {
          "cell": "Sheet1!C2",
          "formula": "=A1 + Sheet2!A1", 
          "expected_value": 110,
          "expected_type": "number",
          "description": "Mixed reference: implicit A1 (Sheet1) + explicit Sheet2!A1 = 10+100=110"
        },
        {
          "cell": "Sheet2!C2",
          "formula": "=A1 + Sheet1!A1",
          "expected_value": 110, 
          "expected_type": "number",
          "description": "Mixed reference: implicit A1 (Sheet2) + explicit Sheet1!A1 = 100+10=110"
        }
      ]
    },
    {
      "level": "3",
      "title": "Cross-Sheet References",
      "description": "Test cross-sheet formula references",
      "category": "cross_sheet",
      "cases": [
        {
          "cell": "Sheet1!D1",
          "formula": "=Sheet2!C1",
          "expected_value": 600,
          "expected_type": "number", 
          "description": "Sheet1 referencing Sheet2 formula result should return 600"
        },
        {
          "cell": "Sheet2!D1",
          "formula": "=Sheet1!C1", 
          "expected_value": 60,
          "expected_type": "number",
          "description": "Sheet2 referencing Sheet1 formula result should return 60"
        }
      ]
    },
    {
      "level": "4",
      "title": "Data Integrity",
      "description": "Verify base data values are correct",
      "category": "data_validation",
      "cases": [
        {
          "cell": "Sheet1!A1",
          "formula": "10",
          "expected_value": 10,
          "expected_type": "number",
          "description": "Sheet1 A1 should contain value 10"
        },
        {
          "cell": "Sheet2!A1", 
          "formula": "100",
          "expected_value": 100,
          "expected_type": "number",
          "description": "Sheet2 A1 should contain value 100"
        }
      ]
    }
  ],
  "expected_behavior": {
    "implicit_references": "Resolve to the sheet where the formula is defined",
    "explicit_references": "Use the explicitly specified sheet",
    "mixed_formulas": "Each reference resolves according to its type (implicit vs explicit)",
    "cross_sheet_formulas": "Reference results from other sheets correctly"
  }
}